/* Copyright 2018-2020 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by
 * applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS
 * OF ANY KIND, either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 */
package com.demo;

import java.io.File;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.webapp.WebAppContext;

/**
 * The application
 * 
 * @author Yong Zhu
 * @since 1.0.0
 */
public class MainApp {

	public static void main(String[] args) throws Exception {

		String projectFolder = new File("").getAbsolutePath();
		String webAppFolder = projectFolder + "/src/main/webapp";
		System.out.println("projectFolder=" + projectFolder);
		System.out.println("classAbsPath=" + Class.class.getClass().getResource("/").getPath());
		System.out.println("webAppFolder=" + webAppFolder);
        try {  
            // 服务器的监听端口  
            Server server = new Server(80);  
            // 关联一个已经存在的上下文  
            WebAppContext context = new WebAppContext();  
            // 设置描述，作为hander加载使用
            context.setDescriptor(webAppFolder+"/WEB-INF/web.xml");  
            // 设置Web内容上下文路径
            context.setResourceBase(webAppFolder);  
            // 设置上下文路径既访问路径的根路径
            context.setContextPath("/");   
            server.setHandler(context);  
            // 启动  
            server.start();  
			Runtime.getRuntime().exec("cmd /c start http://127.0.0.1");
            server.join();  
        } catch ( Exception e) {  
            e.printStackTrace();  
        }   
	}

}
